@page "/"
@inject HttpClient Http
@inject NavigationManager NavigationManager

<div class="container">
    <h1 class="header">Welcome to WheresTheBeer</h1>

    <p>Your go-to app for finding places that serve beer!</p>

    <p class="message">@message</p>

    <button class="button" @onclick="CallApi">Ping the Server</button>

    <button class="button" @onclick="NavigateToPlaces">Find Nearby Places</button>
</div>


@code {
    protected override void OnInitialized()
    {
        Console.WriteLine($"BaseAddress is: {Http.BaseAddress}");
    }

    private string message = "Waiting for server...";

    private async Task CallApi()
    {
        try
        {
            // Log the BaseAddress and the full request URL
            var baseUri = Http.BaseAddress ?? new Uri("https://fallback-url.com/");
            var fullUri = new Uri(baseUri, "api/test/ping");
            Console.WriteLine($"Making request to: {fullUri}");

            // Make the request
            message = await Http.GetStringAsync(fullUri);
        }
        catch (HttpRequestException httpRequestEx)
        {
            message = $"HttpRequestException: {httpRequestEx.Message}";
            Console.WriteLine($"HttpRequestException: {httpRequestEx}");
        }
        catch (Exception ex)
        {
            message = $"Exception: {ex.Message}";
            Console.WriteLine($"Exception: {ex}");
        }
    }

    // Navigation function
    private void NavigateToPlaces()
    {
        NavigationManager.NavigateTo("/places");
    }
}
